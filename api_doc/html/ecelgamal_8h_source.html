<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DataRing: dataring_implementation/native/cryptoSystem/ecelgamal.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>

<div class="header">
  <div class="headertitle">
<div class="title">ecelgamal.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ecelgamal_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2018, Institute for Pervasive Computing, ETH Zurich.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * All rights reserved.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Author:</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *       Lukas Burkhalter &lt;lubu@inf.ethz.ch&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * modification, are permitted provided that the following conditions</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * are met:</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * 1. Redistributions of source code must retain the above copyright</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *    notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *    documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * 3. Neither the name of the copyright holder nor the names of its</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *    contributors may be used to endorse or promote products derived</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *    from this software without specific prior written permission.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * ``AS IS&#39;&#39; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#ifndef ECELGAMAL_ECELGAMAL_H</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#define ECELGAMAL_ECELGAMAL_H</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;openssl/ec.h&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;openssl/bn.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;openssl/objects.h&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;uthash.h&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// Tham extracted from ecparam.c file</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// workaround for the SECG curve names secp192r1 and secp256r1 (which are the same as the curves prime192v1 and prime256v1 defined in X9.62</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a6253ef3e90d14f71acc64d85e304aaeb">   59</a></span>&#160;<span class="preprocessor">#define DEFAULT_CURVE NID_X9_62_prime192v1</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#ad1272278927ecdd1a67330d4600a56c5">   65</a></span>&#160;<span class="preprocessor">#define CURVE_256_SEC NID_X9_62_prime256v1</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a51c241e7ad52441b8d4c1fd5f498b3b9">   70</a></span>&#160;<span class="preprocessor">#define MAX_BITS 32</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">// KEY</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structgamal__key.html">   82</a></span>&#160;<span class="comment"></span><span class="keyword">struct </span><a class="code" href="structgamal__key.html">gamal_key</a></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structgamal__key.html#a786b4936cfc071e084263ecca15b0b83">   84</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structgamal__key.html#a786b4936cfc071e084263ecca15b0b83">is_public</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structgamal__key.html#a643f4697cf37a2644a614663cd6d0930">   85</a></span>&#160;    EC_POINT *<a class="code" href="structgamal__key.html#a643f4697cf37a2644a614663cd6d0930">Y</a>; <span class="comment">//public_key for encrypt</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structgamal__key.html#afd161d66c865544e25e12ba2066b1ad0">   86</a></span>&#160;    BIGNUM *<a class="code" href="structgamal__key.html#afd161d66c865544e25e12ba2066b1ad0">secret</a>; <span class="comment">//private_key for decrypt</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#afe5eae6fdc62e350d243ad21f3df982a">   89</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structgamal__key.html">gamal_key</a> *<a class="code" href="ecelgamal_8h.html#afe5eae6fdc62e350d243ad21f3df982a">gamal_key_ptr</a>; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">   90</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structgamal__key.html">gamal_key</a> <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a>[1]; </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">   91</a></span>&#160;<span class="keyword">typedef</span> uint64_t <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="ecelgamal_8h.html#a55da5654451ad4e78c4ba6bda02c9e07">get_encoded_key_size</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key, <span class="keywordtype">int</span> compressed);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#abe153e6252b5a06310d967f609a8e2fa">encode_key</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buff, <span class="keywordtype">int</span> size, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key, <span class="keywordtype">int</span> compressed);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a345fccdc2facac6565ae023b41735749">decode_key</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buff, <span class="keywordtype">int</span> size);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">// EC POINTS - tuple of Encrytion of x</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structgamal__ciphertext.html">  114</a></span>&#160;<span class="comment"></span><span class="keyword">struct </span><a class="code" href="structgamal__ciphertext.html">gamal_ciphertext</a></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structgamal__ciphertext.html#a675ffabaf15aa0b252d781e2982ee814">  116</a></span>&#160;    EC_POINT *<a class="code" href="structgamal__ciphertext.html#a675ffabaf15aa0b252d781e2982ee814">C1</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structgamal__ciphertext.html#a8ceeee4d3d41ae999ba033bc6a52f4fa">  117</a></span>&#160;    EC_POINT *<a class="code" href="structgamal__ciphertext.html#a8ceeee4d3d41ae999ba033bc6a52f4fa">C2</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;};</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a290ed7c6ce0eea9fced1eaf82a2e5cc5">  120</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structgamal__ciphertext.html">gamal_ciphertext</a> *<a class="code" href="ecelgamal_8h.html#a290ed7c6ce0eea9fced1eaf82a2e5cc5">gamal_ciphertext_ptr</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">  121</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structgamal__ciphertext.html">gamal_ciphertext</a> <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a>[1];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="ecelgamal_8h.html#a312b29259047960c48cf5b167732b40f">get_encoded_ciphertext_size</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#add318d98ca897d353cbf9a7510225a2f">encode_ciphertext</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buff, <span class="keywordtype">int</span> size, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a91f0565166855946d3647dfdab7a3157">decode_ciphertext</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buff, <span class="keywordtype">int</span> size);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structbsgs__hash__table__entry.html">  142</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbsgs__hash__table__entry.html">bsgs_hash_table_entry</a></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structbsgs__hash__table__entry.html#a34379a0e42e3fa9709fa071749a53b79">  144</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="structbsgs__hash__table__entry.html#a34379a0e42e3fa9709fa071749a53b79">key</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structbsgs__hash__table__entry.html#add23d470afc193fd6c399166d6018cd1">  145</a></span>&#160;    uint32_t <a class="code" href="structbsgs__hash__table__entry.html#add23d470afc193fd6c399166d6018cd1">value</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structbsgs__hash__table__entry.html#a4cfeb70291e031e12ccff7bcfdbdfb6b">  146</a></span>&#160;    UT_hash_handle <a class="code" href="structbsgs__hash__table__entry.html#a4cfeb70291e031e12ccff7bcfdbdfb6b">hh</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;} <a class="code" href="ecelgamal_8h.html#ae109743d236eefc6abc1bb9d41c13682">bsgs_hash_table_entry_t</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="structbsgs__table__s.html">  159</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structbsgs__table__s.html">bsgs_table_s</a></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">  161</a></span>&#160;    <a class="code" href="structbsgs__hash__table__entry.html">bsgs_hash_table_entry_t</a> *<a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structbsgs__table__s.html#aba228b4f2862cde9f5ac3f76f98b961d">  162</a></span>&#160;    EC_POINT *<a class="code" href="structbsgs__table__s.html#a7b427bd3da178d4890d1d01fa18a5a23">mG</a>, *<a class="code" href="structbsgs__table__s.html#aba228b4f2862cde9f5ac3f76f98b961d">mG_inv</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structbsgs__table__s.html#ab116bf29b7d2fe677f440bc477fad19a">  163</a></span>&#160;    EC_GROUP *<a class="code" href="structbsgs__table__s.html#ab116bf29b7d2fe677f440bc477fad19a">group</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structbsgs__table__s.html#a6fd6afc4a538f472079bd8d8cdcf8e07">  164</a></span>&#160;    <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> <a class="code" href="structbsgs__table__s.html#a6fd6afc4a538f472079bd8d8cdcf8e07">tablesize</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;};</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a1f4e33f190ace76c83a65a45a27e9178">  166</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbsgs__table__s.html">bsgs_table_s</a> *<a class="code" href="ecelgamal_8h.html#a1f4e33f190ace76c83a65a45a27e9178">bsgs_table_ptr</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">  167</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbsgs__table__s.html">bsgs_table_s</a> <a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a>[1];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#af581959288aea25d4e86f4da0270ce55">gamal_init</a>(<span class="keywordtype">int</span> curve_id);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a748fd010e497a7c660c045e14453c900">gamal_deinit</a>();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;EC_GROUP *<a class="code" href="ecelgamal_8h.html#ad30cf7c6b081e02aa394955d7305c76d">gamal_get_current_group</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a3f903abd1183ad521f8ae71a118a0417">gamal_get_point_compressed_size</a>();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a20abad4bb599201f1fbe7a59578ae2aa">gamal_init_bsgs_table</a>(<a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>, <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> size);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ae486c356b74b709bbf12384299ef888b">gamal_free_bsgs_table</a>(<a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a975513130cccfc171d91c72a33d3c128">gamal_key_clear</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#aa1095ca1c36b141318f51f56b5ac6577">gamal_key_to_public</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> pub, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> priv);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a0db98f08b7b0d49ee723eeb7ca8160d5">gamal_cipher_clear</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ad1b6b17d3a33733f7e9da11175b8b3bb">gamal_cipher_new</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a74dc74f95e15b85703a204f897bcb8c0">gamal_generate_keys</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a0ddfcc673e21b058420e80607e4351a0">gamal_encrypt</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key, <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> plaintext);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ab57e8b44a7e2a3e28d19af8baaae1714">gamal_decrypt</a>(<a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> *res, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ab1a7882d48648e68a7e8e7b2f3f43e91">gamal_add</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> res, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext1, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext2);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//==========================================================================================//</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//=============== Below are functions added by Tham =======================================//</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a2db8d515b3226d0261643313e77685ce">gamal_mult_opt</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> res, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> pt);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#aa5d7fe3f7ab6943c5a677b10961e1c41">gamal_collective_publickey_gen</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> coll_keys, EC_POINT **p_key_list, <span class="keywordtype">int</span> size_key_list);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a882ef9569e075e4f6c45d2db258b60eb">gama_key_switch_lead</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher_update, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys_lead, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keysNew);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ad4f67df871a92ca75c93c90a38a2c321">gama_key_switch_follow</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher_update, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys_follow, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keysNew);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#aa45b941b0f583791b15c9de0b1fd3dad">gamal_re_encrypt</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> new_cipher, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keysNew);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a3125a8c5d02d7ccea7a50349195d5b87">gamal_coll_decrypt_lead</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext_update, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a1b7418d725340e8e681207960dd23c2b">gamal_coll_decrypt_follow</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext_update, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a5429cde99bff5251b3b00b8d63733ca4">gamal_fusion_decrypt</a>(<a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> *res, <span class="keywordtype">int</span> num_server, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key_lead, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> key_follow[], </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext_update, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordtype">int</span> *<a class="code" href="ecelgamal_8h.html#aae3eec0c878d615fad09d825e0e98e4d">convert_to_bin</a>(<span class="keywordtype">int</span> binary_arr[64], <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> number, <span class="keywordtype">int</span> bit_num);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordtype">int</span> *<a class="code" href="ecelgamal_8h.html#a4d0c7980f70a2179cc71c50406b5c004">convert_to_NAF</a>(<span class="keywordtype">int</span> naf_arr[64], <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> number, <span class="keywordtype">int</span> bit_num[2]);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#aa06c1c64ab5df988a45ee41c3c0051f6">mods_func</a>(<span class="keywordtype">int</span> number);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#aae07176b4162284716cd134bcf16c79a">findCeil</a>(<span class="keywordtype">int</span> arr[], <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> l, <span class="keywordtype">int</span> h);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a670a8fd746558ece65166864063c73cf">myRand</a>(<span class="keywordtype">int</span> arr[], <span class="keywordtype">int</span> freq[], <span class="keywordtype">int</span> n);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordtype">int</span> *<a class="code" href="ecelgamal_8h.html#ab51936a51dc12ed398d2c619595586c0">hist_gen</a>(<span class="keywordtype">int</span> histogr[], <span class="keywordtype">int</span> arr[], <span class="keywordtype">int</span> freq[], <span class="keywordtype">int</span> datasize, <span class="keywordtype">int</span> scale_up);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">// int *pir_gen(int myPIR_arr[], int arr[], int freq[], int datasize, double pv_ratio);</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">//=================================================================//</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">// /**</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">//  * Implemented by authors of DataRing.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">//  * This function add the ciphertext to itself for (scalar - 1) times</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//  * Multiply EC-Elgamal ciphertext and a plaintext and stores it in res.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">//  * @param res the resulting ciphertext</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">//  * @param ciphertext</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">//  * @param pt: scalar is an integer &gt;=1 </span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">//  * @return res</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//  */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#a8cb0ebd5607e1c026839538f522bc347">gamal_mult</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> res, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext1, <a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> pt);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">// /**</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">//  * Implemented by authors of DataRing.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">//  * Substract two ciphertexts </span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">//  * Might not be able to decrypt the result, need to double check</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">//  */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#aaf3a255be1a2cdfb3512b00ed8350132">gamal_subtract</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> res, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext1, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext2);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">// /**</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//  * @brief Key switching process of three servers</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">//  * Implemented by authors of DataRing.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">//  * Re-encrypt (switching)) a ciphertext under a collective public key of a group of 3 servers to a ciphertext under a new public key</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">//  * @param new_cipher</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">//  * @param cipher: ciphertext under server&#39;s public key</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">//  * @param keys1, keys2, keys3: three servers&#39; key pairs</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">//  * @param keySNew: new public key</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">//  */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ad3e0adede231b2d2d6a91e58f17dca4b">gamal_key_switching</a>(<a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> new_cipher, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> cipher, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys1, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys2, </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys3, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keysNew);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">// /**</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//  * Implemented by authors of DataRing.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">//  * Collective decrypts an EC-ElGamal ciphertext by 3 servers</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">//  *</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">//  */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#abfdde5bdb3c5f770685df98da810668a">gamal_coll_decrypt</a>(<a class="code" href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a> *res, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys1, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys2, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys3, <a class="code" href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a> ciphertext, <a class="code" href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a> <a class="code" href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">table</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">// /**</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">//  * Implemented by authors of DataRing.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">//  * Generates an collective EC-ElGamal key pair from 3 servers</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">//  * @param coll_keys: the collective keypair</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">//  * @return</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">//  */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">//int gamal_collective_key_gen(gamal_key_t coll_keys);</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ecelgamal_8h.html#ae3697e1cb391f70da0540cc810d4a47d">gamal_collective_key_gen</a>(<a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> coll_keys, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys1, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys2, <a class="code" href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a> keys3);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor">#endif //ECELGAMAL_ECELGAMAL_H</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aecelgamal_8h_html_ad1b6b17d3a33733f7e9da11175b8b3bb"><div class="ttname"><a href="ecelgamal_8h.html#ad1b6b17d3a33733f7e9da11175b8b3bb">gamal_cipher_new</a></div><div class="ttdeci">int gamal_cipher_new(gamal_ciphertext_t cipher)</div><div class="ttdoc">Create a new ciphertext.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00297">ecelgamal.c:297</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ae3697e1cb391f70da0540cc810d4a47d"><div class="ttname"><a href="ecelgamal_8h.html#ae3697e1cb391f70da0540cc810d4a47d">gamal_collective_key_gen</a></div><div class="ttdeci">int gamal_collective_key_gen(gamal_key_t coll_keys, gamal_key_t keys1, gamal_key_t keys2, gamal_key_t keys3)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01204">ecelgamal.c:1204</a></div></div>
<div class="ttc" id="astructgamal__key_html"><div class="ttname"><a href="structgamal__key.html">gamal_key</a></div><div class="ttdoc">This struct defines an EC-Elgamal key pair.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00082">ecelgamal.h:82</a></div></div>
<div class="ttc" id="astructbsgs__table__s_html_ab116bf29b7d2fe677f440bc477fad19a"><div class="ttname"><a href="structbsgs__table__s.html#ab116bf29b7d2fe677f440bc477fad19a">bsgs_table_s::group</a></div><div class="ttdeci">EC_GROUP * group</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00163">ecelgamal.h:163</a></div></div>
<div class="ttc" id="astructgamal__key_html_afd161d66c865544e25e12ba2066b1ad0"><div class="ttname"><a href="structgamal__key.html#afd161d66c865544e25e12ba2066b1ad0">gamal_key::secret</a></div><div class="ttdeci">BIGNUM * secret</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00086">ecelgamal.h:86</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a2db8d515b3226d0261643313e77685ce"><div class="ttname"><a href="ecelgamal_8h.html#a2db8d515b3226d0261643313e77685ce">gamal_mult_opt</a></div><div class="ttdeci">int gamal_mult_opt(gamal_ciphertext_t res, gamal_ciphertext_t ciphertext, dig_t pt)</div><div class="ttdoc">Multiplication of a ciphertext by a scalar.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00627">ecelgamal.c:627</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ad3e0adede231b2d2d6a91e58f17dca4b"><div class="ttname"><a href="ecelgamal_8h.html#ad3e0adede231b2d2d6a91e58f17dca4b">gamal_key_switching</a></div><div class="ttdeci">int gamal_key_switching(gamal_ciphertext_t new_cipher, gamal_ciphertext_t cipher, gamal_key_t keys1, gamal_key_t keys2, gamal_key_t keys3, gamal_key_t keysNew)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01033">ecelgamal.c:1033</a></div></div>
<div class="ttc" id="astructbsgs__table__s_html_a58d36a37ed16968b3070602d387b5069"><div class="ttname"><a href="structbsgs__table__s.html#a58d36a37ed16968b3070602d387b5069">bsgs_table_s::table</a></div><div class="ttdeci">bsgs_hash_table_entry_t * table</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00161">ecelgamal.h:161</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a670a8fd746558ece65166864063c73cf"><div class="ttname"><a href="ecelgamal_8h.html#a670a8fd746558ece65166864063c73cf">myRand</a></div><div class="ttdeci">int myRand(int arr[], int freq[], int n)</div><div class="ttdoc">Helper function for the scalar multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="generate__enc__vectors_8c_source.html#l00025">generate_enc_vectors.c:25</a></div></div>
<div class="ttc" id="astructbsgs__hash__table__entry_html_a34379a0e42e3fa9709fa071749a53b79"><div class="ttname"><a href="structbsgs__hash__table__entry.html#a34379a0e42e3fa9709fa071749a53b79">bsgs_hash_table_entry::key</a></div><div class="ttdeci">unsigned char * key</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00144">ecelgamal.h:144</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a8cb0ebd5607e1c026839538f522bc347"><div class="ttname"><a href="ecelgamal_8h.html#a8cb0ebd5607e1c026839538f522bc347">gamal_mult</a></div><div class="ttdeci">int gamal_mult(gamal_ciphertext_t res, gamal_ciphertext_t ciphertext1, dig_t pt)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00759">ecelgamal.c:759</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a3125a8c5d02d7ccea7a50349195d5b87"><div class="ttname"><a href="ecelgamal_8h.html#a3125a8c5d02d7ccea7a50349195d5b87">gamal_coll_decrypt_lead</a></div><div class="ttdeci">int gamal_coll_decrypt_lead(gamal_ciphertext_t ciphertext_update, gamal_key_t keys, gamal_ciphertext_t ciphertext, bsgs_table_t table)</div><div class="ttdoc">A leading server initiate the threshold decryption.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00886">ecelgamal.c:886</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a20abad4bb599201f1fbe7a59578ae2aa"><div class="ttname"><a href="ecelgamal_8h.html#a20abad4bb599201f1fbe7a59578ae2aa">gamal_init_bsgs_table</a></div><div class="ttdeci">int gamal_init_bsgs_table(bsgs_table_t table, dig_t size)</div><div class="ttdoc">Inititlaizes the baby-step-giant-step table.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00262">ecelgamal.c:262</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_afe5eae6fdc62e350d243ad21f3df982a"><div class="ttname"><a href="ecelgamal_8h.html#afe5eae6fdc62e350d243ad21f3df982a">gamal_key_ptr</a></div><div class="ttdeci">struct gamal_key * gamal_key_ptr</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00089">ecelgamal.h:89</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_af581959288aea25d4e86f4da0270ce55"><div class="ttname"><a href="ecelgamal_8h.html#af581959288aea25d4e86f4da0270ce55">gamal_init</a></div><div class="ttdeci">int gamal_init(int curve_id)</div><div class="ttdoc">Inits the library with the given curve.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00246">ecelgamal.c:246</a></div></div>
<div class="ttc" id="astructgamal__key_html_a643f4697cf37a2644a614663cd6d0930"><div class="ttname"><a href="structgamal__key.html#a643f4697cf37a2644a614663cd6d0930">gamal_key::Y</a></div><div class="ttdeci">EC_POINT * Y</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00085">ecelgamal.h:85</a></div></div>
<div class="ttc" id="astructbsgs__hash__table__entry_html_add23d470afc193fd6c399166d6018cd1"><div class="ttname"><a href="structbsgs__hash__table__entry.html#add23d470afc193fd6c399166d6018cd1">bsgs_hash_table_entry::value</a></div><div class="ttdeci">uint32_t value</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00145">ecelgamal.h:145</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a882ef9569e075e4f6c45d2db258b60eb"><div class="ttname"><a href="ecelgamal_8h.html#a882ef9569e075e4f6c45d2db258b60eb">gama_key_switch_lead</a></div><div class="ttdeci">int gama_key_switch_lead(gamal_ciphertext_t cipher_update, gamal_ciphertext_t cipher, gamal_key_t keys_lead, gamal_key_t keysNew)</div><div class="ttdoc">A leading server initiates the key switching of an encryption to under a new collective public key.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00954">ecelgamal.c:954</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aae07176b4162284716cd134bcf16c79a"><div class="ttname"><a href="ecelgamal_8h.html#aae07176b4162284716cd134bcf16c79a">findCeil</a></div><div class="ttdeci">int findCeil(int arr[], int r, int l, int h)</div><div class="ttdoc">Helper function for the scalar multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="generate__enc__vectors_8c_source.html#l00008">generate_enc_vectors.c:8</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a5429cde99bff5251b3b00b8d63733ca4"><div class="ttname"><a href="ecelgamal_8h.html#a5429cde99bff5251b3b00b8d63733ca4">gamal_fusion_decrypt</a></div><div class="ttdeci">int gamal_fusion_decrypt(dig_t *res, int num_server, gamal_key_t key_lead, gamal_key_t key_follow[], gamal_ciphertext_t ciphertext_update, gamal_ciphertext_t ciphertext, bsgs_table_t table)</div><div class="ttdoc">All servers jointly compute the final plaintext of a ciphertext from the threshold decryption.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00847">ecelgamal.c:847</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a290ed7c6ce0eea9fced1eaf82a2e5cc5"><div class="ttname"><a href="ecelgamal_8h.html#a290ed7c6ce0eea9fced1eaf82a2e5cc5">gamal_ciphertext_ptr</a></div><div class="ttdeci">struct gamal_ciphertext * gamal_ciphertext_ptr</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00120">ecelgamal.h:120</a></div></div>
<div class="ttc" id="astructgamal__ciphertext_html_a675ffabaf15aa0b252d781e2982ee814"><div class="ttname"><a href="structgamal__ciphertext.html#a675ffabaf15aa0b252d781e2982ee814">gamal_ciphertext::C1</a></div><div class="ttdeci">EC_POINT * C1</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00116">ecelgamal.h:116</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ad4f67df871a92ca75c93c90a38a2c321"><div class="ttname"><a href="ecelgamal_8h.html#ad4f67df871a92ca75c93c90a38a2c321">gama_key_switch_follow</a></div><div class="ttdeci">int gama_key_switch_follow(gamal_ciphertext_t cipher_update, gamal_ciphertext_t cipher, gamal_key_t keys_follow, gamal_key_t keysNew)</div><div class="ttdoc">A following server operations in the key switching of an encryption to under a new collective public ...</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00993">ecelgamal.c:993</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a7ae7fb2f843f29e6c50849cc89399a5e"><div class="ttname"><a href="ecelgamal_8h.html#a7ae7fb2f843f29e6c50849cc89399a5e">gamal_ciphertext_t</a></div><div class="ttdeci">struct gamal_ciphertext gamal_ciphertext_t[1]</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00121">ecelgamal.h:121</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a55da5654451ad4e78c4ba6bda02c9e07"><div class="ttname"><a href="ecelgamal_8h.html#a55da5654451ad4e78c4ba6bda02c9e07">get_encoded_key_size</a></div><div class="ttdeci">size_t get_encoded_key_size(gamal_key_t key, int compressed)</div><div class="ttdoc">Get the size of the encoded key.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00479">ecelgamal.c:479</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a91f0565166855946d3647dfdab7a3157"><div class="ttname"><a href="ecelgamal_8h.html#a91f0565166855946d3647dfdab7a3157">decode_ciphertext</a></div><div class="ttdeci">int decode_ciphertext(gamal_ciphertext_t ciphertext, unsigned char *buff, int size)</div><div class="ttdoc">Decode a ciphertext.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00459">ecelgamal.c:459</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ab1a7882d48648e68a7e8e7b2f3f43e91"><div class="ttname"><a href="ecelgamal_8h.html#ab1a7882d48648e68a7e8e7b2f3f43e91">gamal_add</a></div><div class="ttdeci">int gamal_add(gamal_ciphertext_t res, gamal_ciphertext_t ciphertext1, gamal_ciphertext_t ciphertext2)</div><div class="ttdoc">Adds two EC-Elgamal ciphertext and stores it in res.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00386">ecelgamal.c:386</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a748fd010e497a7c660c045e14453c900"><div class="ttname"><a href="ecelgamal_8h.html#a748fd010e497a7c660c045e14453c900">gamal_deinit</a></div><div class="ttdeci">int gamal_deinit()</div><div class="ttdoc">Deinits the library.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00252">ecelgamal.c:252</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a975513130cccfc171d91c72a33d3c128"><div class="ttname"><a href="ecelgamal_8h.html#a975513130cccfc171d91c72a33d3c128">gamal_key_clear</a></div><div class="ttdeci">int gamal_key_clear(gamal_key_t keys)</div><div class="ttdoc">Clear a key pair.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00273">ecelgamal.c:273</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ae109743d236eefc6abc1bb9d41c13682"><div class="ttname"><a href="ecelgamal_8h.html#ae109743d236eefc6abc1bb9d41c13682">bsgs_hash_table_entry_t</a></div><div class="ttdeci">struct bsgs_hash_table_entry bsgs_hash_table_entry_t</div><div class="ttdoc">This struct defines a hash table for the EC Elgamal decryption algorithm.</div></div>
<div class="ttc" id="aecelgamal_8h_html_ae486c356b74b709bbf12384299ef888b"><div class="ttname"><a href="ecelgamal_8h.html#ae486c356b74b709bbf12384299ef888b">gamal_free_bsgs_table</a></div><div class="ttdeci">int gamal_free_bsgs_table(bsgs_table_t table)</div><div class="ttdoc">Frees the memory of the table.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00267">ecelgamal.c:267</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ab51936a51dc12ed398d2c619595586c0"><div class="ttname"><a href="ecelgamal_8h.html#ab51936a51dc12ed398d2c619595586c0">hist_gen</a></div><div class="ttdeci">int * hist_gen(int histogr[], int arr[], int freq[], int datasize, int scale_up)</div><div class="ttdoc">Helper function for generating a histogram.</div><div class="ttdef"><b>Definition:</b> <a href="generate__enc__vectors_8c_source.html#l00046">generate_enc_vectors.c:46</a></div></div>
<div class="ttc" id="astructbsgs__table__s_html_aba228b4f2862cde9f5ac3f76f98b961d"><div class="ttname"><a href="structbsgs__table__s.html#aba228b4f2862cde9f5ac3f76f98b961d">bsgs_table_s::mG_inv</a></div><div class="ttdeci">EC_POINT * mG_inv</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00162">ecelgamal.h:162</a></div></div>
<div class="ttc" id="astructbsgs__table__s_html_a6fd6afc4a538f472079bd8d8cdcf8e07"><div class="ttname"><a href="structbsgs__table__s.html#a6fd6afc4a538f472079bd8d8cdcf8e07">bsgs_table_s::tablesize</a></div><div class="ttdeci">dig_t tablesize</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00164">ecelgamal.h:164</a></div></div>
<div class="ttc" id="astructbsgs__table__s_html_a7b427bd3da178d4890d1d01fa18a5a23"><div class="ttname"><a href="structbsgs__table__s.html#a7b427bd3da178d4890d1d01fa18a5a23">bsgs_table_s::mG</a></div><div class="ttdeci">EC_POINT * mG</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00162">ecelgamal.h:162</a></div></div>
<div class="ttc" id="astructgamal__ciphertext_html"><div class="ttname"><a href="structgamal__ciphertext.html">gamal_ciphertext</a></div><div class="ttdoc">This struct defines an EC-Elgamal ciphertext.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00114">ecelgamal.h:114</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ab57e8b44a7e2a3e28d19af8baaae1714"><div class="ttname"><a href="ecelgamal_8h.html#ab57e8b44a7e2a3e28d19af8baaae1714">gamal_decrypt</a></div><div class="ttdeci">int gamal_decrypt(dig_t *res, gamal_key_t key, gamal_ciphertext_t ciphertext, bsgs_table_t table)</div><div class="ttdoc">Decrypts an EC-Elgamal ciphertext.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00356">ecelgamal.c:356</a></div></div>
<div class="ttc" id="astructgamal__key_html_a786b4936cfc071e084263ecca15b0b83"><div class="ttname"><a href="structgamal__key.html#a786b4936cfc071e084263ecca15b0b83">gamal_key::is_public</a></div><div class="ttdeci">char is_public</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00084">ecelgamal.h:84</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aa45b941b0f583791b15c9de0b1fd3dad"><div class="ttname"><a href="ecelgamal_8h.html#aa45b941b0f583791b15c9de0b1fd3dad">gamal_re_encrypt</a></div><div class="ttdeci">int gamal_re_encrypt(gamal_ciphertext_t new_cipher, gamal_ciphertext_t cipher, gamal_key_t keys, gamal_key_t keysNew)</div><div class="ttdoc">Simple re-encrytion function.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01120">ecelgamal.c:1120</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a1f4e33f190ace76c83a65a45a27e9178"><div class="ttname"><a href="ecelgamal_8h.html#a1f4e33f190ace76c83a65a45a27e9178">bsgs_table_ptr</a></div><div class="ttdeci">struct bsgs_table_s * bsgs_table_ptr</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00166">ecelgamal.h:166</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_abe153e6252b5a06310d967f609a8e2fa"><div class="ttname"><a href="ecelgamal_8h.html#abe153e6252b5a06310d967f609a8e2fa">encode_key</a></div><div class="ttdeci">int encode_key(unsigned char *buff, int size, gamal_key_t key, int compressed)</div><div class="ttdoc">Encode a key.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00498">ecelgamal.c:498</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a74dc74f95e15b85703a204f897bcb8c0"><div class="ttname"><a href="ecelgamal_8h.html#a74dc74f95e15b85703a204f897bcb8c0">gamal_generate_keys</a></div><div class="ttdeci">int gamal_generate_keys(gamal_key_t keys)</div><div class="ttdoc">Generates an EC-Elgamal key pair.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00304">ecelgamal.c:304</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a1b7418d725340e8e681207960dd23c2b"><div class="ttname"><a href="ecelgamal_8h.html#a1b7418d725340e8e681207960dd23c2b">gamal_coll_decrypt_follow</a></div><div class="ttdeci">int gamal_coll_decrypt_follow(gamal_ciphertext_t ciphertext_update, gamal_key_t keys, gamal_ciphertext_t ciphertext, bsgs_table_t table)</div><div class="ttdoc">Following servers join the threshold decryption.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00893">ecelgamal.c:893</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_abfdde5bdb3c5f770685df98da810668a"><div class="ttname"><a href="ecelgamal_8h.html#abfdde5bdb3c5f770685df98da810668a">gamal_coll_decrypt</a></div><div class="ttdeci">int gamal_coll_decrypt(dig_t *res, gamal_key_t keys1, gamal_key_t keys2, gamal_key_t keys3, gamal_ciphertext_t ciphertext, bsgs_table_t table)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00913">ecelgamal.c:913</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aa06c1c64ab5df988a45ee41c3c0051f6"><div class="ttname"><a href="ecelgamal_8h.html#aa06c1c64ab5df988a45ee41c3c0051f6">mods_func</a></div><div class="ttdeci">int mods_func(int number)</div><div class="ttdoc">Helper function for the scalar multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01326">ecelgamal.c:1326</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_ad30cf7c6b081e02aa394955d7305c76d"><div class="ttname"><a href="ecelgamal_8h.html#ad30cf7c6b081e02aa394955d7305c76d">gamal_get_current_group</a></div><div class="ttdeci">EC_GROUP * gamal_get_current_group()</div><div class="ttdoc">Returns the EC_Group (elliptic curve group) struct if initialized.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00408">ecelgamal.c:408</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a0db6828e45e50899115d040a0b3e9f57"><div class="ttname"><a href="ecelgamal_8h.html#a0db6828e45e50899115d040a0b3e9f57">bsgs_table_t</a></div><div class="ttdeci">struct bsgs_table_s bsgs_table_t[1]</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00167">ecelgamal.h:167</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a0db98f08b7b0d49ee723eeb7ca8160d5"><div class="ttname"><a href="ecelgamal_8h.html#a0db98f08b7b0d49ee723eeb7ca8160d5">gamal_cipher_clear</a></div><div class="ttdeci">int gamal_cipher_clear(gamal_ciphertext_t cipher)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00290">ecelgamal.c:290</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aa1095ca1c36b141318f51f56b5ac6577"><div class="ttname"><a href="ecelgamal_8h.html#aa1095ca1c36b141318f51f56b5ac6577">gamal_key_to_public</a></div><div class="ttdeci">int gamal_key_to_public(gamal_key_t pub, gamal_key_t priv)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00283">ecelgamal.c:283</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a4d0c7980f70a2179cc71c50406b5c004"><div class="ttname"><a href="ecelgamal_8h.html#a4d0c7980f70a2179cc71c50406b5c004">convert_to_NAF</a></div><div class="ttdeci">int * convert_to_NAF(int naf_arr[64], dig_t number, int bit_num[2])</div><div class="ttdoc">Helper function for the scalar multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01291">ecelgamal.c:1291</a></div></div>
<div class="ttc" id="astructgamal__ciphertext_html_a8ceeee4d3d41ae999ba033bc6a52f4fa"><div class="ttname"><a href="structgamal__ciphertext.html#a8ceeee4d3d41ae999ba033bc6a52f4fa">gamal_ciphertext::C2</a></div><div class="ttdeci">EC_POINT * C2</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00117">ecelgamal.h:117</a></div></div>
<div class="ttc" id="astructbsgs__hash__table__entry_html_a4cfeb70291e031e12ccff7bcfdbdfb6b"><div class="ttname"><a href="structbsgs__hash__table__entry.html#a4cfeb70291e031e12ccff7bcfdbdfb6b">bsgs_hash_table_entry::hh</a></div><div class="ttdeci">UT_hash_handle hh</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00146">ecelgamal.h:146</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a020deff602315de6e1a3652d16b63a5b"><div class="ttname"><a href="ecelgamal_8h.html#a020deff602315de6e1a3652d16b63a5b">dig_t</a></div><div class="ttdeci">uint64_t dig_t</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00091">ecelgamal.h:91</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a3f903abd1183ad521f8ae71a118a0417"><div class="ttname"><a href="ecelgamal_8h.html#a3f903abd1183ad521f8ae71a118a0417">gamal_get_point_compressed_size</a></div><div class="ttdeci">int gamal_get_point_compressed_size()</div><div class="ttdoc">Returns the encded size of an EC-Point in this group.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00413">ecelgamal.c:413</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aaf3a255be1a2cdfb3512b00ed8350132"><div class="ttname"><a href="ecelgamal_8h.html#aaf3a255be1a2cdfb3512b00ed8350132">gamal_subtract</a></div><div class="ttdeci">int gamal_subtract(gamal_ciphertext_t res, gamal_ciphertext_t ciphertext1, gamal_ciphertext_t ciphertext2)</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00819">ecelgamal.c:819</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_add318d98ca897d353cbf9a7510225a2f"><div class="ttname"><a href="ecelgamal_8h.html#add318d98ca897d353cbf9a7510225a2f">encode_ciphertext</a></div><div class="ttdeci">int encode_ciphertext(unsigned char *buff, int size, gamal_ciphertext_t ciphertext)</div><div class="ttdoc">Encode a ciphertext.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00440">ecelgamal.c:440</a></div></div>
<div class="ttc" id="astructbsgs__table__s_html"><div class="ttname"><a href="structbsgs__table__s.html">bsgs_table_s</a></div><div class="ttdoc">This struct defines a hash table for the EC Elgamal decryption algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00159">ecelgamal.h:159</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aae3eec0c878d615fad09d825e0e98e4d"><div class="ttname"><a href="ecelgamal_8h.html#aae3eec0c878d615fad09d825e0e98e4d">convert_to_bin</a></div><div class="ttdeci">int * convert_to_bin(int binary_arr[64], dig_t number, int bit_num)</div><div class="ttdoc">Helper function for the scalar multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01245">ecelgamal.c:1245</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a345fccdc2facac6565ae023b41735749"><div class="ttname"><a href="ecelgamal_8h.html#a345fccdc2facac6565ae023b41735749">decode_key</a></div><div class="ttdeci">int decode_key(gamal_key_t key, unsigned char *buff, int size)</div><div class="ttdoc">Decode a key.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00558">ecelgamal.c:558</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a0ddfcc673e21b058420e80607e4351a0"><div class="ttname"><a href="ecelgamal_8h.html#a0ddfcc673e21b058420e80607e4351a0">gamal_encrypt</a></div><div class="ttdeci">int gamal_encrypt(gamal_ciphertext_t ciphertext, gamal_key_t key, dig_t plaintext)</div><div class="ttdoc">Encrypts an Integer with additadive homomorphic EC-ElGamal.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00326">ecelgamal.c:326</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a9a9e74ea3e48cb25776d5bf7c339dfb1"><div class="ttname"><a href="ecelgamal_8h.html#a9a9e74ea3e48cb25776d5bf7c339dfb1">gamal_key_t</a></div><div class="ttdeci">struct gamal_key gamal_key_t[1]</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00090">ecelgamal.h:90</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_a312b29259047960c48cf5b167732b40f"><div class="ttname"><a href="ecelgamal_8h.html#a312b29259047960c48cf5b167732b40f">get_encoded_ciphertext_size</a></div><div class="ttdeci">size_t get_encoded_ciphertext_size(gamal_ciphertext_t ciphertext)</div><div class="ttdoc">Get the size of the encoded ciphertext.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l00435">ecelgamal.c:435</a></div></div>
<div class="ttc" id="aecelgamal_8h_html_aa5d7fe3f7ab6943c5a677b10961e1c41"><div class="ttname"><a href="ecelgamal_8h.html#aa5d7fe3f7ab6943c5a677b10961e1c41">gamal_collective_publickey_gen</a></div><div class="ttdeci">int gamal_collective_publickey_gen(gamal_key_t coll_keys, EC_POINT **p_key_list, int size_key_list)</div><div class="ttdoc">Generate a collective public key from a set of public keys.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8c_source.html#l01165">ecelgamal.c:1165</a></div></div>
<div class="ttc" id="astructbsgs__hash__table__entry_html"><div class="ttname"><a href="structbsgs__hash__table__entry.html">bsgs_hash_table_entry</a></div><div class="ttdoc">This struct defines a hash table for the EC Elgamal decryption algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="ecelgamal_8h_source.html#l00142">ecelgamal.h:142</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>

</small></address>
</body>
</html>
